<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hourly Forecast</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f4f4f4;
    }
    h1 {
      margin-bottom: 20px;
    }
    .forecast {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 15px;
    }
    .hour {
      background: white;
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      font-size: 0.9em;
      white-space: pre-line;
    }
  </style>
</head>
<body>
  <h1>Hourly Weather Forecast</h1>
  <div class="forecast" id="forecast">Loading...</div>

  <script>
    const codes = {
      0: 'Clear sky',
      1: 'Mainly clear',
      2: 'Partly cloudy',
      3: 'Overcast',
      45: 'Fog',
      48: 'Depositing rime fog',
      51: 'Light drizzle',
      53: 'Moderate drizzle',
      55: 'Dense drizzle',
      56: 'Freezing light drizzle',
      57: 'Freezing dense drizzle',
      61: 'Slight rain',
      63: 'Moderate rain',
      65: 'Heavy rain',
      66: 'Freezing light rain',
      67: 'Freezing heavy rain',
      71: 'Slight snow fall',
      73: 'Moderate snow fall',
      75: 'Heavy snow fall',
      77: 'Snow grains',
      80: 'Slight rain showers',
      81: 'Moderate rain showers',
      82: 'Violent rain showers',
      85: 'Slight snow showers',
      86: 'Heavy snow showers',
      95: 'Thunderstorm',
      96: 'Thunderstorm with slight hail',
      99: 'Thunderstorm with heavy hail'
    };

    async function fetchHourlyForecast() {
      const url = 'https://api.open-meteo.com/v1/forecast?latitude=52.52&longitude=13.41&hourly=temperature_2m,weathercode,windspeed_10m,precipitation_probability&timezone=auto';
      const res = await fetch(url);
      const data = await res.json();
      const hours = data.hourly.time;
      const temps = data.hourly.temperature_2m;
      const winds = data.hourly.windspeed_10m;
      const codesData = data.hourly.weathercode;
      const rainProbs = data.hourly.precipitation_probability;

      const forecastEl = document.getElementById('forecast');
      forecastEl.innerHTML = '';

      const now = new Date();
      const currentHour = now.getHours();
      const startIndex = hours.findIndex(t => new Date(t).getHours() === currentHour && new Date(t).getDate() === now.getDate());

      for (let i = startIndex; i < startIndex + 24 && i < hours.length; i++) {
        const hourTime = new Date(hours[i]);
        const hourStr = hourTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        const temp = temps[i];
        const wind = winds[i];
        const code = codesData[i];
        const rain = rainProbs[i];
        const condition = codes[code] || 'Unknown';

        const block = document.createElement('div');
        block.className = 'hour';
        block.innerText =
          `Time: ${hourStr}\n` +
          `Temp: ${temp}Â°C\n` +
          `Wind: ${wind} km/h\n` +
          `Condition: ${condition}\n` +
          `Rain: ${rain}%`;

        forecastEl.appendChild(block);
      }
    }

    fetchHourlyForecast();
    setInterval(fetchHourlyForecast, 3600000);
  </script>
</body>
</html>
